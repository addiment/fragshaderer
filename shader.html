<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="shader.css">
    <title>Fragment Shader Sandbox</title>
</head>

<body>
    <div id="ccontain">
        <canvas id="glcanv" width="640" height="480">No WebGL?</canvas>
        <textarea id="fragsrc" spellcheck="false">#version 300 es
#define PI 3.141592
precision highp float;

// replacement for gl_FragColor
out vec4 fragColor;
in highp vec2 texcoord;
uniform uint time;
uniform uvec2 viewportSize; 
uniform vec4 userParam;
uniform sampler2D userTexture;
uniform sampler2D lightTexture;

float d(vec2 uv) {
    return sqrt(pow(0.5 - uv.x, 2.0) + pow(0.5 - uv.y, 2.0));
}

void main() {
    float a = PI * (texcoord.x - 0.5);
    vec2 v = vec2(cos(a), sin(a)) * (texcoord.y / 2.0);
    vec2 pc = mix(
        texcoord,
        // {0.5, 0.5} = center
        vec2(0.5, 0.5) + v,
        // lerp amount
        vec2((userParam.w + 1.0) / 2.0)
    );
    float r = float(viewportSize.y) / float(viewportSize.x);

    fragColor = texture(
        lightTexture,
        texcoord * (vec2(1.0) / vec2(textureSize(lightTexture, 0))) // / vec2(textureSize(lightTexture, 0))
    );
    //fragColor = (texture( userTexture, pc ) * (1.0 - texture(lightTexture, texcoord / vec2(textureSize(lightTexture, 0))).a)) + texture(lightTexture, texcoord / vec2(textureSize(lightTexture, 0)));
}</textarea>
        <img id="glimg" src="scene.png" hidden>
        <img id="lightimg" src="light.png" hidden>
    </div>
    <div id="controlsd">
        <button id="bcompile">Compile</button>
        <div class="dfc"><input type="range" id="customx" min="-1" max="1" step="0.05" value="0"><label
                for="customx">X</label></div>
        <div class="dfc"><input type="range" id="customy" min="-1" max="1" step="0.05" value="0"><label
                for="customy">Y</label></div>
        <div class="dfc"><input type="range" id="customz" min="-1" max="1" step="0.05" value="0"><label
                for="customz">Z</label></div>
        <div class="dfc"><input type="range" id="customw" min="-1" max="1" step="0.05" value="1"><label
                for="customw">W</label></div>
        <div class="dfc"><input type="checkbox" id="usepxviewport"><label for="usepxviewport">Use absolute
                viewport</label></div>
        <p>Status: <span id="glstatus" class="good">Compiled</span></p>
    </div>
</body>

<script src="shader.js"></script>

</html>